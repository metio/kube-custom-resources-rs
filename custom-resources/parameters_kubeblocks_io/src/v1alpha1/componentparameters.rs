// WARNING: generated by kopium - manual changes will be overwritten
// kopium command: kopium --docs --derive=Default --derive=PartialEq --smart-derive-elision --filename crd-catalog/apecloud/kubeblocks/parameters.kubeblocks.io/v1alpha1/componentparameters.yaml
// kopium version: 0.22.1

#[allow(unused_imports)]
mod prelude {
    pub use kube::CustomResource;
    pub use serde::{Serialize, Deserialize};
    pub use std::collections::BTreeMap;
    pub use k8s_openapi::apimachinery::pkg::apis::meta::v1::Condition;
}
use self::prelude::*;

/// ComponentParameterSpec defines the desired state of ComponentConfiguration
#[derive(CustomResource, Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
#[kube(group = "parameters.kubeblocks.io", version = "v1alpha1", kind = "ComponentParameter", plural = "componentparameters")]
#[kube(namespaced)]
#[kube(status = "ComponentParameterStatus")]
#[kube(schema = "disabled")]
#[kube(derive="Default")]
#[kube(derive="PartialEq")]
pub struct ComponentParameterSpec {
    /// Specifies the name of the Cluster that this configuration is associated with.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "clusterName")]
    pub cluster_name: Option<String>,
    /// Represents the name of the Component that this configuration pertains to.
    #[serde(rename = "componentName")]
    pub component_name: String,
    /// ConfigItemDetails is an array of ConfigTemplateItemDetail objects.
    /// 
    /// 
    /// Each ConfigTemplateItemDetail corresponds to a configuration template,
    /// which is a ConfigMap that contains multiple configuration files.
    /// Each configuration file is stored as a key-value pair within the ConfigMap.
    /// 
    /// 
    /// The ConfigTemplateItemDetail includes information such as:
    /// 
    /// 
    /// - The configuration template (a ConfigMap)
    /// - The corresponding ConfigConstraint (constraints and validation rules for the configuration)
    /// - Volume mounts (for mounting the configuration files)
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "configItemDetails")]
    pub config_item_details: Option<Vec<ComponentParameterConfigItemDetails>>,
}

/// ConfigTemplateItemDetail corresponds to settings of a configuration template (a ConfigMap).
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct ComponentParameterConfigItemDetails {
    /// Specifies the user-defined configuration parameters.
    /// 
    /// 
    /// When provided, the parameter values in `configFileParams` override the default configuration parameters.
    /// This allows users to override the default configuration according to their specific needs.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "configFileParams")]
    pub config_file_params: Option<BTreeMap<String, ComponentParameterConfigItemDetailsConfigFileParams>>,
    /// Specifies the name of the configuration template (a ConfigMap), ConfigConstraint, and other miscellaneous options.
    /// 
    /// 
    /// The configuration template is a ConfigMap that contains multiple configuration files.
    /// Each configuration file is stored as a key-value pair within the ConfigMap.
    /// 
    /// 
    /// ConfigConstraint allows defining constraints and validation rules for configuration parameters.
    /// It ensures that the configuration adheres to certain requirements and limitations.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "configSpec")]
    pub config_spec: Option<ComponentParameterConfigItemDetailsConfigSpec>,
    /// Defines the unique identifier of the configuration template.
    /// 
    /// 
    /// It must be a string of maximum 63 characters, and can only include lowercase alphanumeric characters,
    /// hyphens, and periods.
    /// The name must start and end with an alphanumeric character.
    pub name: String,
    /// External controllers can trigger a configuration rerender by modifying this field.
    /// 
    /// 
    /// Note: Currently, the `payload` field is opaque and its content is not interpreted by the system.
    /// Modifying this field will cause a rerender, regardless of the specific content of this field.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub payload: Option<BTreeMap<String, serde_json::Value>>,
    /// Specifies the user-defined configuration template.
    /// 
    /// 
    /// When provided, the `importTemplateRef` overrides the default configuration template
    /// specified in `configSpec.templateRef`.
    /// This allows users to customize the configuration template according to their specific requirements.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "userConfigTemplates")]
    pub user_config_templates: Option<ComponentParameterConfigItemDetailsUserConfigTemplates>,
}

/// Specifies the user-defined configuration parameters.
/// 
/// 
/// When provided, the parameter values in `configFileParams` override the default configuration parameters.
/// This allows users to override the default configuration according to their specific needs.
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct ComponentParameterConfigItemDetailsConfigFileParams {
    /// Holds the configuration keys and values. This field is a workaround for issues found in kubebuilder and code-generator.
    /// Refer to <https://github.com/kubernetes-sigs/kubebuilder/issues/528> and <https://github.com/kubernetes/code-generator/issues/50> for more details.
    /// 
    /// 
    /// Represents the content of the configuration file.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub content: Option<String>,
    /// Represents the updated parameters for a single configuration file.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub parameters: Option<BTreeMap<String, String>>,
}

/// Specifies the name of the configuration template (a ConfigMap), ConfigConstraint, and other miscellaneous options.
/// 
/// 
/// The configuration template is a ConfigMap that contains multiple configuration files.
/// Each configuration file is stored as a key-value pair within the ConfigMap.
/// 
/// 
/// ConfigConstraint allows defining constraints and validation rules for configuration parameters.
/// It ensures that the configuration adheres to certain requirements and limitations.
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct ComponentParameterConfigItemDetailsConfigSpec {
    /// The operator attempts to set default file permissions (0444).
    /// 
    /// 
    /// Must be specified as an octal value between 0000 and 0777 (inclusive),
    /// or as a decimal value between 0 and 511 (inclusive).
    /// YAML supports both octal and decimal values for file permissions.
    /// 
    /// 
    /// Please note that this setting only affects the permissions of the files themselves.
    /// Directories within the specified path are not impacted by this setting.
    /// It's important to be aware that this setting might conflict with other options
    /// that influence the file mode, such as fsGroup.
    /// In such cases, the resulting file mode may have additional bits set.
    /// Refers to documents of k8s.ConfigMapVolumeSource.defaultMode for more information.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "defaultMode")]
    pub default_mode: Option<i32>,
    /// ExternalManaged indicates whether the configuration is managed by an external system.
    /// When set to true, the controller will ignore the management of this configuration.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "externalManaged")]
    pub external_managed: Option<bool>,
    /// Specifies the name of the template.
    pub name: String,
    /// Specifies the namespace of the referenced template ConfigMap object.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub namespace: Option<String>,
    /// Specifies whether to restart the pod when the file changes.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "restartOnFileChange")]
    pub restart_on_file_change: Option<bool>,
    /// Specifies the name of the referenced template ConfigMap object.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub template: Option<String>,
    /// Refers to the volume name of PodTemplate. The file produced through the template will be mounted to
    /// the corresponding volume. Must be a DNS_LABEL name.
    /// The volume name must be defined in podSpec.containers[*].volumeMounts.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "volumeName")]
    pub volume_name: Option<String>,
}

/// Specifies the user-defined configuration template.
/// 
/// 
/// When provided, the `importTemplateRef` overrides the default configuration template
/// specified in `configSpec.templateRef`.
/// This allows users to customize the configuration template according to their specific requirements.
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct ComponentParameterConfigItemDetailsUserConfigTemplates {
    /// Specifies the namespace of the referenced configuration template ConfigMap object.
    /// An empty namespace is equivalent to the "default" namespace.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub namespace: Option<String>,
    /// Defines the strategy for merging externally imported templates into component templates.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub policy: Option<ComponentParameterConfigItemDetailsUserConfigTemplatesPolicy>,
    /// Specifies the name of the referenced configuration template ConfigMap object.
    #[serde(rename = "templateRef")]
    pub template_ref: String,
}

/// Specifies the user-defined configuration template.
/// 
/// 
/// When provided, the `importTemplateRef` overrides the default configuration template
/// specified in `configSpec.templateRef`.
/// This allows users to customize the configuration template according to their specific requirements.
#[derive(Serialize, Deserialize, Clone, Debug, PartialEq)]
pub enum ComponentParameterConfigItemDetailsUserConfigTemplatesPolicy {
    #[serde(rename = "patch")]
    Patch,
    #[serde(rename = "replace")]
    Replace,
    #[serde(rename = "none")]
    None,
}

/// ComponentParameterStatus defines the observed state of ComponentConfiguration
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct ComponentParameterStatus {
    /// Provides detailed status information for opsRequest.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub conditions: Option<Vec<Condition>>,
    /// Provides the status of each component undergoing reconfiguration.
    #[serde(rename = "configurationStatus")]
    pub configuration_status: Vec<ComponentParameterStatusConfigurationStatus>,
    /// Provides a description of any abnormal status.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub message: Option<String>,
    /// Represents the latest generation observed for this
    /// ClusterDefinition. It corresponds to the ConfigConstraint's generation, which is
    /// updated by the API Server.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "observedGeneration")]
    pub observed_generation: Option<i64>,
    /// Indicates the current status of the configuration item.
    /// 
    /// 
    /// Possible values include "Creating", "Init", "Running", "Pending", "Merged", "MergeFailed", "FailedAndPause",
    /// "Upgrading", "Deleting", "FailedAndRetry", "Finished".
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub phase: Option<ComponentParameterStatusPhase>,
}

#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct ComponentParameterStatusConfigurationStatus {
    /// Represents the last completed revision of the configuration item. This field is optional.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "lastDoneRevision")]
    pub last_done_revision: Option<String>,
    /// Provides a description of any abnormal status. This field is optional.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub message: Option<String>,
    /// Specifies the name of the configuration template. It is a required field and must be a string of maximum 63 characters.
    /// The name should only contain lowercase alphanumeric characters, hyphens, or periods. It should start and end with an alphanumeric character.
    pub name: String,
    /// Indicates the current status of the configuration item.
    /// 
    /// 
    /// Possible values include "Creating", "Init", "Running", "Pending", "Merged", "MergeFailed", "FailedAndPause",
    /// "Upgrading", "Deleting", "FailedAndRetry", "Finished".
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub phase: Option<ComponentParameterStatusConfigurationStatusPhase>,
    /// Provides detailed information about the execution of the configuration change. This field is optional.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "reconcileDetail")]
    pub reconcile_detail: Option<ComponentParameterStatusConfigurationStatusReconcileDetail>,
    /// Represents the updated revision of the configuration item. This field is optional.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "updateRevision")]
    pub update_revision: Option<String>,
}

#[derive(Serialize, Deserialize, Clone, Debug, PartialEq)]
pub enum ComponentParameterStatusConfigurationStatusPhase {
    Creating,
    Init,
    Running,
    Pending,
    Merged,
    MergeFailed,
    FailedAndPause,
    Upgrading,
    Deleting,
    FailedAndRetry,
    Finished,
}

/// Provides detailed information about the execution of the configuration change. This field is optional.
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct ComponentParameterStatusConfigurationStatusReconcileDetail {
    /// Represents the current revision of the configuration item.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "currentRevision")]
    pub current_revision: Option<String>,
    /// Represents the error message generated when the execution of configuration changes fails.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "errMessage")]
    pub err_message: Option<String>,
    /// Represents the outcome of the most recent execution.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "execResult")]
    pub exec_result: Option<String>,
    /// Represents the total number of pods that require execution of configuration changes.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "expectedCount")]
    pub expected_count: Option<i32>,
    /// Represents the policy applied during the most recent execution.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub policy: Option<String>,
    /// Represents the number of pods where configuration changes were successfully applied.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "succeedCount")]
    pub succeed_count: Option<i32>,
}

/// ComponentParameterStatus defines the observed state of ComponentConfiguration
#[derive(Serialize, Deserialize, Clone, Debug, PartialEq)]
pub enum ComponentParameterStatusPhase {
    Creating,
    Init,
    Running,
    Pending,
    Merged,
    MergeFailed,
    FailedAndPause,
    Upgrading,
    Deleting,
    FailedAndRetry,
    Finished,
}

