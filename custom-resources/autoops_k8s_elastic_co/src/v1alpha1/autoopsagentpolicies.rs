// WARNING: generated by kopium - manual changes will be overwritten
// kopium command: kopium --docs --derive=Default --derive=PartialEq --smart-derive-elision --filename crd-catalog/elastic/cloud-on-k8s/autoops.k8s.elastic.co/v1alpha1/autoopsagentpolicies.yaml
// kopium version: 0.22.5

#[allow(unused_imports)]
mod prelude {
    pub use kube::CustomResource;
    pub use serde::{Serialize, Deserialize};
    pub use std::collections::BTreeMap;
}
use self::prelude::*;

#[derive(CustomResource, Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
#[kube(group = "autoops.k8s.elastic.co", version = "v1alpha1", kind = "AutoOpsAgentPolicy", plural = "autoopsagentpolicies")]
#[kube(namespaced)]
#[kube(status = "AutoOpsAgentPolicyStatus")]
#[kube(schema = "disabled")]
#[kube(derive="Default")]
#[kube(derive="PartialEq")]
pub struct AutoOpsAgentPolicySpec {
    /// AutoOpsRef defines a reference to a secret containing connection details for AutoOps via Cloud Connect.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "autoOpsRef")]
    pub auto_ops_ref: Option<AutoOpsAgentPolicyAutoOpsRef>,
    /// Image is the AutoOps Agent Docker image to deploy.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub image: Option<String>,
    /// NamespaceSelector is a namespace selector for the resources to be configured.
    /// Any Elasticsearch instances that belong to the selected namespaces will be configured to send data to AutoOps.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "namespaceSelector")]
    pub namespace_selector: Option<AutoOpsAgentPolicyNamespaceSelector>,
    /// PodTemplate provides customisation options (labels, annotations, affinity rules, resource requests, and so on) for the Agent pods
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "podTemplate")]
    pub pod_template: Option<BTreeMap<String, serde_json::Value>>,
    /// ResourceSelector is a label selector for the resources to be configured.
    /// Any Elasticsearch instances that match the selector will be configured to send data to AutoOps.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "resourceSelector")]
    pub resource_selector: Option<AutoOpsAgentPolicyResourceSelector>,
    /// RevisionHistoryLimit is the number of revisions to retain to allow rollback in the underlying Deployment.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "revisionHistoryLimit")]
    pub revision_history_limit: Option<i32>,
    /// ServiceAccountName is used to check access to Elasticsearch resources in different namespaces.
    /// Can only be used if ECK is enforcing RBAC on references (--enforce-rbac-on-refs flag).
    /// The service account must have "get" permission on elasticsearch.k8s.elastic.co/elasticsearches
    /// in the target namespaces.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "serviceAccountName")]
    pub service_account_name: Option<String>,
    /// Version of the AutoOpsAgentPolicy.
    pub version: String,
}

/// AutoOpsRef defines a reference to a secret containing connection details for AutoOps via Cloud Connect.
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct AutoOpsAgentPolicyAutoOpsRef {
    /// SecretName references a Secret containing connection details for external AutoOps.
    /// Required when connecting via Cloud Connect. The secret must contain:
    /// - `cloud-connected-mode-api-key`: Cloud Connected Mode API key
    /// - `autoops-otel-url`: AutoOps OpenTelemetry endpoint URL
    /// - `autoops-token`: AutoOps authentication token
    /// - `cloud-connected-mode-api-url`: (optional) Cloud Connected Mode API URL
    /// This field cannot be used in combination with `name`.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "secretName")]
    pub secret_name: Option<String>,
}

/// NamespaceSelector is a namespace selector for the resources to be configured.
/// Any Elasticsearch instances that belong to the selected namespaces will be configured to send data to AutoOps.
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct AutoOpsAgentPolicyNamespaceSelector {
    /// matchExpressions is a list of label selector requirements. The requirements are ANDed.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "matchExpressions")]
    pub match_expressions: Option<Vec<AutoOpsAgentPolicyNamespaceSelectorMatchExpressions>>,
    /// matchLabels is a map of {key,value} pairs. A single {key,value} in the matchLabels
    /// map is equivalent to an element of matchExpressions, whose key field is "key", the
    /// operator is "In", and the values array contains only "value". The requirements are ANDed.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "matchLabels")]
    pub match_labels: Option<BTreeMap<String, String>>,
}

/// A label selector requirement is a selector that contains values, a key, and an operator that
/// relates the key and values.
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct AutoOpsAgentPolicyNamespaceSelectorMatchExpressions {
    /// key is the label key that the selector applies to.
    pub key: String,
    /// operator represents a key's relationship to a set of values.
    /// Valid operators are In, NotIn, Exists and DoesNotExist.
    pub operator: String,
    /// values is an array of string values. If the operator is In or NotIn,
    /// the values array must be non-empty. If the operator is Exists or DoesNotExist,
    /// the values array must be empty. This array is replaced during a strategic
    /// merge patch.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub values: Option<Vec<String>>,
}

/// ResourceSelector is a label selector for the resources to be configured.
/// Any Elasticsearch instances that match the selector will be configured to send data to AutoOps.
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct AutoOpsAgentPolicyResourceSelector {
    /// matchExpressions is a list of label selector requirements. The requirements are ANDed.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "matchExpressions")]
    pub match_expressions: Option<Vec<AutoOpsAgentPolicyResourceSelectorMatchExpressions>>,
    /// matchLabels is a map of {key,value} pairs. A single {key,value} in the matchLabels
    /// map is equivalent to an element of matchExpressions, whose key field is "key", the
    /// operator is "In", and the values array contains only "value". The requirements are ANDed.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "matchLabels")]
    pub match_labels: Option<BTreeMap<String, String>>,
}

/// A label selector requirement is a selector that contains values, a key, and an operator that
/// relates the key and values.
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct AutoOpsAgentPolicyResourceSelectorMatchExpressions {
    /// key is the label key that the selector applies to.
    pub key: String,
    /// operator represents a key's relationship to a set of values.
    /// Valid operators are In, NotIn, Exists and DoesNotExist.
    pub operator: String,
    /// values is an array of string values. If the operator is In or NotIn,
    /// the values array must be non-empty. If the operator is Exists or DoesNotExist,
    /// the values array must be empty. This array is replaced during a strategic
    /// merge patch.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub values: Option<Vec<String>>,
}

#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct AutoOpsAgentPolicyStatus {
    /// Errors is the number of resources that are in an error state.
    pub errors: i64,
    /// ObservedGeneration is the most recent generation observed for this AutoOpsAgentPolicy.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "observedGeneration")]
    pub observed_generation: Option<i64>,
    /// Phase is the phase of the AutoOpsAgentPolicy.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub phase: Option<String>,
    /// Ready is the number of resources that are in a ready state.
    pub ready: i64,
    /// Resources is the number of resources that match the ResourceSelector.
    pub resources: i64,
}

