// WARNING: generated by kopium - manual changes will be overwritten
// kopium command: kopium --docs --derive=Default --derive=PartialEq --smart-derive-elision --filename crd-catalog/controlplaneio-fluxcd/flux-operator/fluxcd.controlplane.io/v1/resourcesets.yaml
// kopium version: 0.21.1

#[allow(unused_imports)]
mod prelude {
    pub use kube::CustomResource;
    pub use serde::{Serialize, Deserialize};
    pub use std::collections::BTreeMap;
    pub use k8s_openapi::apimachinery::pkg::apis::meta::v1::Condition;
}
use self::prelude::*;

/// ResourceSetSpec defines the desired state of ResourceSet
#[derive(CustomResource, Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
#[kube(group = "fluxcd.controlplane.io", version = "v1", kind = "ResourceSet", plural = "resourcesets")]
#[kube(namespaced)]
#[kube(status = "ResourceSetStatus")]
#[kube(schema = "disabled")]
#[kube(derive="Default")]
#[kube(derive="PartialEq")]
pub struct ResourceSetSpec {
    /// CommonMetadata specifies the common labels and annotations that are
    /// applied to all resources. Any existing label or annotation will be
    /// overridden if its key matches a common one.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "commonMetadata")]
    pub common_metadata: Option<ResourceSetCommonMetadata>,
    /// DependsOn specifies the list of Kubernetes resources that must
    /// exist on the cluster before the reconciliation process starts.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "dependsOn")]
    pub depends_on: Option<Vec<ResourceSetDependsOn>>,
    /// Inputs contains the list of ResourceSet inputs.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub inputs: Option<Vec<BTreeMap<String, serde_json::Value>>>,
    /// InputsFrom contains the list of references to input providers.
    /// When set, the inputs are fetched from the providers and concatenated
    /// with the in-line inputs defined in the ResourceSet.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "inputsFrom")]
    pub inputs_from: Option<Vec<ResourceSetInputsFrom>>,
    /// Resources contains the list of Kubernetes resources to reconcile.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub resources: Option<Vec<BTreeMap<String, serde_json::Value>>>,
    /// ResourcesTemplate is a Go template that generates the list of
    /// Kubernetes resources to reconcile. The template is rendered
    /// as multi-document YAML, the resources should be separated by '---'.
    /// When both Resources and ResourcesTemplate are set, the resulting
    /// objects are merged and deduplicated, with the ones from Resources taking precedence.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "resourcesTemplate")]
    pub resources_template: Option<String>,
    /// The name of the Kubernetes service account to impersonate
    /// when reconciling the generated resources.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "serviceAccountName")]
    pub service_account_name: Option<String>,
    /// Wait instructs the controller to check the health
    /// of all the reconciled resources.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub wait: Option<bool>,
}

/// CommonMetadata specifies the common labels and annotations that are
/// applied to all resources. Any existing label or annotation will be
/// overridden if its key matches a common one.
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct ResourceSetCommonMetadata {
    /// Annotations to be added to the object's metadata.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub annotations: Option<BTreeMap<String, String>>,
    /// Labels to be added to the object's metadata.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub labels: Option<BTreeMap<String, String>>,
}

/// Dependency defines a ResourceSet dependency on a Kubernetes resource.
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct ResourceSetDependsOn {
    /// APIVersion of the resource to depend on.
    #[serde(rename = "apiVersion")]
    pub api_version: String,
    /// Kind of the resource to depend on.
    pub kind: String,
    /// Name of the resource to depend on.
    pub name: String,
    /// Namespace of the resource to depend on.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub namespace: Option<String>,
    /// Ready checks if the resource Ready status condition is true.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub ready: Option<bool>,
    /// ReadyExpr checks if the resource satisfies the given CEL expression.
    /// The expression replaces the default readiness check and
    /// is only evaluated if Ready is set to 'true'.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "readyExpr")]
    pub ready_expr: Option<String>,
}

#[derive(Serialize, Deserialize, Clone, Debug, PartialEq)]
pub struct ResourceSetInputsFrom {
    /// APIVersion of the input provider resource.
    /// When not set, the APIVersion of the ResourceSet is used.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "apiVersion")]
    pub api_version: Option<String>,
    /// Kind of the input provider resource.
    pub kind: ResourceSetInputsFromKind,
    /// Name of the input provider resource.
    pub name: String,
}

#[derive(Serialize, Deserialize, Clone, Debug, PartialEq)]
pub enum ResourceSetInputsFromKind {
    ResourceSetInputProvider,
}

/// ResourceSetStatus defines the observed state of ResourceSet.
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct ResourceSetStatus {
    /// Conditions contains the readiness conditions of the object.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub conditions: Option<Vec<Condition>>,
    /// Inventory contains a list of Kubernetes resource object references
    /// last applied on the cluster.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub inventory: Option<ResourceSetStatusInventory>,
    /// LastAppliedRevision is the digest of the
    /// generated resources that were last reconcile.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "lastAppliedRevision")]
    pub last_applied_revision: Option<String>,
    /// LastHandledReconcileAt holds the value of the most recent
    /// reconcile request value, so a change of the annotation value
    /// can be detected.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "lastHandledReconcileAt")]
    pub last_handled_reconcile_at: Option<String>,
}

/// Inventory contains a list of Kubernetes resource object references
/// last applied on the cluster.
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct ResourceSetStatusInventory {
    /// Entries of Kubernetes resource object references.
    pub entries: Vec<ResourceSetStatusInventoryEntries>,
}

/// ResourceRef contains the information necessary to locate a resource within a cluster.
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct ResourceSetStatusInventoryEntries {
    /// ID is the string representation of the Kubernetes resource object's metadata,
    /// in the format '<namespace>_<name>_<group>_<kind>'.
    pub id: String,
    /// Version is the API version of the Kubernetes resource object's kind.
    pub v: String,
}

