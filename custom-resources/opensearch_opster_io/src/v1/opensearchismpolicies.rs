// WARNING: generated by kopium - manual changes will be overwritten
// kopium command: kopium --docs --derive=Default --derive=PartialEq --smart-derive-elision --filename crd-catalog/opensearch-project/opensearch-k8s-operator/opensearch.opster.io/v1/opensearchismpolicies.yaml
// kopium version: 0.21.1

#[allow(unused_imports)]
mod prelude {
    pub use kube::CustomResource;
    pub use serde::{Serialize, Deserialize};
}
use self::prelude::*;

/// ISMPolicySpec is the specification for the ISM policy for OS.
#[derive(CustomResource, Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
#[kube(group = "opensearch.opster.io", version = "v1", kind = "OpenSearchISMPolicy", plural = "opensearchismpolicies")]
#[kube(namespaced)]
#[kube(status = "OpenSearchISMPolicyStatus")]
#[kube(schema = "disabled")]
#[kube(derive="Default")]
#[kube(derive="PartialEq")]
pub struct OpenSearchISMPolicySpec {
    /// The default starting state for each index that uses this policy.
    #[serde(rename = "defaultState")]
    pub default_state: String,
    /// A human-readable description of the policy.
    pub description: String,
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "errorNotification")]
    pub error_notification: Option<OpenSearchISMPolicyErrorNotification>,
    /// Specify an ISM template pattern that matches the index to apply the policy.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "ismTemplate")]
    pub ism_template: Option<OpenSearchISMPolicyIsmTemplate>,
    /// LocalObjectReference contains enough information to let you locate the
    /// referenced object inside the same namespace.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "opensearchCluster")]
    pub opensearch_cluster: Option<OpenSearchISMPolicyOpensearchCluster>,
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "policyId")]
    pub policy_id: Option<String>,
    /// The states that you define in the policy.
    pub states: Vec<OpenSearchISMPolicyStates>,
}

#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct OpenSearchISMPolicyErrorNotification {
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub channel: Option<String>,
    /// The destination URL.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub destination: Option<OpenSearchISMPolicyErrorNotificationDestination>,
    /// The text of the message
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "messageTemplate")]
    pub message_template: Option<OpenSearchISMPolicyErrorNotificationMessageTemplate>,
}

/// The destination URL.
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct OpenSearchISMPolicyErrorNotificationDestination {
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub amazon: Option<OpenSearchISMPolicyErrorNotificationDestinationAmazon>,
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub chime: Option<OpenSearchISMPolicyErrorNotificationDestinationChime>,
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "customWebhook")]
    pub custom_webhook: Option<OpenSearchISMPolicyErrorNotificationDestinationCustomWebhook>,
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub slack: Option<OpenSearchISMPolicyErrorNotificationDestinationSlack>,
}

#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct OpenSearchISMPolicyErrorNotificationDestinationAmazon {
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub url: Option<String>,
}

#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct OpenSearchISMPolicyErrorNotificationDestinationChime {
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub url: Option<String>,
}

#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct OpenSearchISMPolicyErrorNotificationDestinationCustomWebhook {
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub url: Option<String>,
}

#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct OpenSearchISMPolicyErrorNotificationDestinationSlack {
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub url: Option<String>,
}

/// The text of the message
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct OpenSearchISMPolicyErrorNotificationMessageTemplate {
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub source: Option<String>,
}

/// Specify an ISM template pattern that matches the index to apply the policy.
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct OpenSearchISMPolicyIsmTemplate {
    /// Index patterns on which this policy has to be applied
    #[serde(rename = "indexPatterns")]
    pub index_patterns: Vec<String>,
    /// Priority of the template, defaults to 0
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub priority: Option<i64>,
}

/// LocalObjectReference contains enough information to let you locate the
/// referenced object inside the same namespace.
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct OpenSearchISMPolicyOpensearchCluster {
    /// Name of the referent.
    /// More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names
    /// TODO: Add other useful fields. apiVersion, kind, uid?
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub name: Option<String>,
}

#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct OpenSearchISMPolicyStates {
    /// The actions to execute after entering a state.
    pub actions: Vec<OpenSearchISMPolicyStatesActions>,
    /// The name of the state.
    pub name: String,
    /// The next states and the conditions required to transition to those states. If no transitions exist, the policy assumes that it’s complete and can now stop managing the index
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub transitions: Option<Vec<OpenSearchISMPolicyStatesTransitions>>,
}

/// Actions are the steps that the policy sequentially executes on entering a specific state.
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct OpenSearchISMPolicyStatesActions {
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub alias: Option<OpenSearchISMPolicyStatesActionsAlias>,
    /// Allocate the index to a node with a specific attribute set
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub allocation: Option<OpenSearchISMPolicyStatesActionsAllocation>,
    /// Closes the managed index.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub close: Option<OpenSearchISMPolicyStatesActionsClose>,
    /// Deletes a managed index.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub delete: Option<OpenSearchISMPolicyStatesActionsDelete>,
    /// Reduces the number of Lucene segments by merging the segments of individual shards.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "forceMerge")]
    pub force_merge: Option<OpenSearchISMPolicyStatesActionsForceMerge>,
    /// Set the priority for the index in a specific state.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "indexPriority")]
    pub index_priority: Option<OpenSearchISMPolicyStatesActionsIndexPriority>,
    /// Name          string        `json:"name,omitempty"`
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub notification: Option<OpenSearchISMPolicyStatesActionsNotification>,
    /// Opens a managed index.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub open: Option<OpenSearchISMPolicyStatesActionsOpen>,
    /// Sets a managed index to be read only.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "readOnly")]
    pub read_only: Option<OpenSearchISMPolicyStatesActionsReadOnly>,
    /// Sets a managed index to be writeable.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "readWrite")]
    pub read_write: Option<OpenSearchISMPolicyStatesActionsReadWrite>,
    /// Sets the number of replicas to assign to an index.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "replicaCount")]
    pub replica_count: Option<OpenSearchISMPolicyStatesActionsReplicaCount>,
    /// The retry configuration for the action.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub retry: Option<OpenSearchISMPolicyStatesActionsRetry>,
    /// Rolls an alias over to a new index when the managed index meets one of the rollover conditions.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub rollover: Option<OpenSearchISMPolicyStatesActionsRollover>,
    /// Periodically reduce data granularity by rolling up old data into summarized indexes.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub rollup: Option<OpenSearchISMPolicyStatesActionsRollup>,
    /// Allows you to reduce the number of primary shards in your indexes
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub shrink: Option<OpenSearchISMPolicyStatesActionsShrink>,
    /// Back up your cluster’s indexes and state
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub snapshot: Option<OpenSearchISMPolicyStatesActionsSnapshot>,
    /// The timeout period for the action. Accepts time units for minutes, hours, and days.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub timeout: Option<String>,
}

#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct OpenSearchISMPolicyStatesActionsAlias {
    /// Allocate the index to a node with a specified attribute.
    pub actions: Vec<OpenSearchISMPolicyStatesActionsAliasActions>,
}

#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct OpenSearchISMPolicyStatesActionsAliasActions {
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub add: Option<OpenSearchISMPolicyStatesActionsAliasActionsAdd>,
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub remove: Option<OpenSearchISMPolicyStatesActionsAliasActionsRemove>,
}

#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct OpenSearchISMPolicyStatesActionsAliasActionsAdd {
    /// The name of the alias.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub aliases: Option<Vec<String>>,
    /// The name of the index that the alias points to.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub index: Option<String>,
    /// Specify the index that accepts any write operations to the alias.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "isWriteIndex")]
    pub is_write_index: Option<bool>,
    /// Limit search to an associated shard value
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub routing: Option<String>,
}

#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct OpenSearchISMPolicyStatesActionsAliasActionsRemove {
    /// The name of the alias.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub aliases: Option<Vec<String>>,
    /// The name of the index that the alias points to.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub index: Option<String>,
    /// Specify the index that accepts any write operations to the alias.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "isWriteIndex")]
    pub is_write_index: Option<bool>,
    /// Limit search to an associated shard value
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub routing: Option<String>,
}

/// Allocate the index to a node with a specific attribute set
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct OpenSearchISMPolicyStatesActionsAllocation {
    /// Allocate the index to a node with a specified attribute.
    pub exclude: String,
    /// Allocate the index to a node with any of the specified attributes.
    pub include: String,
    /// Don’t allocate the index to a node with any of the specified attributes.
    pub require: String,
    /// Wait for the policy to execute before allocating the index to a node with a specified attribute.
    #[serde(rename = "waitFor")]
    pub wait_for: String,
}

/// Closes the managed index.
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct OpenSearchISMPolicyStatesActionsClose {
}

/// Deletes a managed index.
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct OpenSearchISMPolicyStatesActionsDelete {
}

/// Reduces the number of Lucene segments by merging the segments of individual shards.
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct OpenSearchISMPolicyStatesActionsForceMerge {
    /// The number of segments to reduce the shard to.
    #[serde(rename = "maxNumSegments")]
    pub max_num_segments: i64,
}

/// Set the priority for the index in a specific state.
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct OpenSearchISMPolicyStatesActionsIndexPriority {
    /// The priority for the index as soon as it enters a state.
    pub priority: i64,
}

/// Name          string        `json:"name,omitempty"`
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct OpenSearchISMPolicyStatesActionsNotification {
    pub destination: String,
    #[serde(rename = "messageTemplate")]
    pub message_template: OpenSearchISMPolicyStatesActionsNotificationMessageTemplate,
}

#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct OpenSearchISMPolicyStatesActionsNotificationMessageTemplate {
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub source: Option<String>,
}

/// Opens a managed index.
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct OpenSearchISMPolicyStatesActionsOpen {
}

/// Sets a managed index to be read only.
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct OpenSearchISMPolicyStatesActionsReadOnly {
}

/// Sets a managed index to be writeable.
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct OpenSearchISMPolicyStatesActionsReadWrite {
}

/// Sets the number of replicas to assign to an index.
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct OpenSearchISMPolicyStatesActionsReplicaCount {
    #[serde(rename = "numberOfReplicas")]
    pub number_of_replicas: i64,
}

/// The retry configuration for the action.
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct OpenSearchISMPolicyStatesActionsRetry {
    /// The backoff policy type to use when retrying.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub backoff: Option<String>,
    /// The number of retry counts.
    pub count: i64,
    /// The time to wait between retries.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub delay: Option<String>,
}

/// Rolls an alias over to a new index when the managed index meets one of the rollover conditions.
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct OpenSearchISMPolicyStatesActionsRollover {
    /// The minimum number of documents required to roll over the index.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "minDocCount")]
    pub min_doc_count: Option<i64>,
    /// The minimum age required to roll over the index.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "minIndexAge")]
    pub min_index_age: Option<String>,
    /// The minimum storage size of a single primary shard required to roll over the index.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "minPrimaryShardSize")]
    pub min_primary_shard_size: Option<String>,
    /// The minimum size of the total primary shard storage (not counting replicas) required to roll over the index.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "minSize")]
    pub min_size: Option<String>,
}

/// Periodically reduce data granularity by rolling up old data into summarized indexes.
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct OpenSearchISMPolicyStatesActionsRollup {
}

/// Allows you to reduce the number of primary shards in your indexes
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct OpenSearchISMPolicyStatesActionsShrink {
    /// If true, executes the shrink action even if there are no replicas.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "forceUnsafe")]
    pub force_unsafe: Option<bool>,
    /// The maximum size in bytes of a shard for the target index.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "maxShardSize")]
    pub max_shard_size: Option<String>,
    /// The maximum number of primary shards in the shrunken index.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "numNewShards")]
    pub num_new_shards: Option<i64>,
    /// Percentage of the number of original primary shards to shrink.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "percentageOfSourceShards")]
    pub percentage_of_source_shards: Option<i64>,
    /// The name of the shrunken index.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "targetIndexNameTemplate")]
    pub target_index_name_template: Option<String>,
}

/// Back up your cluster’s indexes and state
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct OpenSearchISMPolicyStatesActionsSnapshot {
    /// The repository name that you register through the native snapshot API operations.
    pub repository: String,
    /// The name of the snapshot.
    pub snapshot: String,
}

#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct OpenSearchISMPolicyStatesTransitions {
    /// conditions for the transition.
    pub conditions: OpenSearchISMPolicyStatesTransitionsConditions,
    /// The name of the state to transition to if the conditions are met.
    #[serde(rename = "stateName")]
    pub state_name: String,
}

/// conditions for the transition.
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct OpenSearchISMPolicyStatesTransitionsConditions {
    /// The cron job that triggers the transition if no other transition happens first.
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub cron: Option<OpenSearchISMPolicyStatesTransitionsConditionsCron>,
    /// The minimum document count of the index required to transition.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "minDocCount")]
    pub min_doc_count: Option<i64>,
    /// The minimum age of the index required to transition.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "minIndexAge")]
    pub min_index_age: Option<String>,
    /// The minimum age required after a rollover has occurred to transition to the next state.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "minRolloverAge")]
    pub min_rollover_age: Option<String>,
    /// The minimum size of the total primary shard storage (not counting replicas) required to transition.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "minSize")]
    pub min_size: Option<String>,
}

/// The cron job that triggers the transition if no other transition happens first.
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct OpenSearchISMPolicyStatesTransitionsConditionsCron {
    /// A wrapper for the cron job that triggers the transition if no other transition happens first. This wrapper is here to adhere to the OpenSearch API.
    pub cron: OpenSearchISMPolicyStatesTransitionsConditionsCronCron,
}

/// A wrapper for the cron job that triggers the transition if no other transition happens first. This wrapper is here to adhere to the OpenSearch API.
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct OpenSearchISMPolicyStatesTransitionsConditionsCronCron {
    /// The cron expression that triggers the transition.
    pub expression: String,
    /// The timezone that triggers the transition.
    pub timezone: String,
}

/// OpensearchISMPolicyStatus defines the observed state of OpensearchISMPolicy
#[derive(Serialize, Deserialize, Clone, Debug, Default, PartialEq)]
pub struct OpenSearchISMPolicyStatus {
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "existingISMPolicy")]
    pub existing_ism_policy: Option<bool>,
    /// UID is a type that holds unique ID values, including UUIDs.  Because we
    /// don't ONLY use UUIDs, this is an alias to string.  Being a type captures
    /// intent and helps make sure that UIDs and names do not get conflated.
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "managedCluster")]
    pub managed_cluster: Option<String>,
    #[serde(default, skip_serializing_if = "Option::is_none", rename = "policyId")]
    pub policy_id: Option<String>,
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub reason: Option<String>,
    #[serde(default, skip_serializing_if = "Option::is_none")]
    pub state: Option<String>,
}

